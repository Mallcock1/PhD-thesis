\documentclass[12pt]{../style-files/ociamthesis}
 
\usepackage{amssymb}
\usepackage{titlesec}
\usepackage{amsmath}
\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subfig}
\usepackage{xcolor}
\usepackage[section]{placeins}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{stmaryrd}
\usepackage{siunitx}
\usepackage{rotating}
\usepackage[utf8]{inputenc}
\usepackage[round]{natbib}
\usepackage{tikz}
\usetikzlibrary{fadings}
\usetikzlibrary{arrows,shapes, positioning}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{rotating}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% the following is to alter tikz settings to improve springs figure.
\usetikzlibrary{decorations.pathmorphing,calc,patterns}
\makeatletter
\def\pgfdecorationspringstraightlinelength{0.5cm}
\def\pgfdecorationspringnumberofelement{8}
\def\pgfdecorationspringnaturallength{5cm}
\pgfkeys{%
	/pgf/decoration/.cd,
	spring straight line length/.code={%
		\pgfmathsetlengthmacro\pgfdecorationspringstraightlinelength{#1}},
	spring natural length/.code={%
		\pgfmathsetlengthmacro\pgfdecorationspringnaturallength{#1}},
	spring number of element/.store in=\pgfdecorationspringnumberofelement
}

\pgfdeclaredecoration{coil spring}{straight line}{%
	\state{straight line}[%
	persistent precomputation = {%
		% Compute the effective length of the spring (without the length
		% of the two straight lines): \pgfdecorationspringeffectivelength
		\pgfmathsetlengthmacro{\pgfdecorationspringeffectivelength}%
		{\pgfdecoratedpathlength-2*\pgfdecorationspringstraightlinelength}
		% Compute the effective length of one coil pattern:
		% \pgfdecorationspringeffectivelengthofonecoil
		\pgfmathsetlengthmacro{\pgfdecorationspringeffectivelengthofonecoil}%
		{\pgfdecorationspringeffectivelength/\pgfdecorationspringnumberofelement}
	},
	width = \pgfdecorationspringstraightlinelength,
	next state = draw spring]{%
		\pgfpathlineto{%
			\pgfqpoint{%
				\pgfdecorationspringstraightlinelength}{0pt}}
	}
	\state{draw spring}%
	[width=\pgfdecorationspringeffectivelengthofonecoil,
	repeat state=\pgfdecorationspringnumberofelement-1,next state=final]{%
		\pgfpathcurveto
		{\pgfpoint@onspringcoil{0    }{ 0.555}{1}}
		{\pgfpoint@onspringcoil{0.445}{ 1    }{2}}
		{\pgfpoint@onspringcoil{1    }{ 1    }{3}}
		\pgfpathcurveto
		{\pgfpoint@onspringcoil{1.555}{ 1    }{4}}
		{\pgfpoint@onspringcoil{2    }{ 0.555}{5}}
		{\pgfpoint@onspringcoil{2    }{ 0    }{6}}
		\pgfpathcurveto
		{\pgfpoint@onspringcoil{2    }{-0.555}{7}}
		{\pgfpoint@onspringcoil{1.555}{-1    }{8}}
		{\pgfpoint@onspringcoil{1    }{-1    }{9}}
		\pgfpathcurveto
		{\pgfpoint@onspringcoil{0.445}{-1    }{10}}
		{\pgfpoint@onspringcoil{0    }{-0.555}{11}}
		{\pgfpoint@onspringcoil{0    }{ 0    }{12}}
	}
	\state{final}{%
		\pgfpathlineto{\pgfpointdecoratedpathlast}
	}
}

\def\pgfpoint@onspringcoil#1#2#3{%
	\pgf@x=#1\pgfdecorationsegmentamplitude%
	\pgf@x=.5\pgf@x%
	\pgf@y=#2\pgfdecorationsegmentamplitude%
	\pgfmathparse{0.083333333333*\pgfdecorationspringeffectivelengthofonecoil}%
	\pgf@xa=\pgfmathresult pt
	\advance\pgf@x by#3\pgf@xa%
}

\makeatother

\tikzset{%
	Spring/.style = {%
		decoration = {%
			coil spring,
			spring straight line length = 0.2cm,
			% To be added
			spring natural length = #1,
			spring number of element = 4,
			amplitude=2mm},
		decorate,
		very thick},
	Spring/.default = {4cm}}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{geometry}
 \geometry{
 a4paper,
 left=40mm,
 right=30mm,
 top=30mm,
 bottom=30mm
 }

\definecolor{theblue}{HTML}{0000CD}

% disable this package for printed version
\usepackage[colorlinks=true, linktocpage=true, allcolors=theblue]{hyperref}

\titleformat{\chapter}[display]
  {\bfseries\Large}
  {\filright\MakeUppercase{\chaptertitlename} \Large\thechapter}
  {1ex}
  {}
  [\vspace{1ex} \hrule \vspace{1pt} \hrule]

\newcommand{\adv}{    {\it Adv. Space Res.}} 
\newcommand{\annG}{   {\it Ann. Geophys.}} 
\newcommand{\aap}{    {\it Astron. Astrophys.}}
\newcommand{\aaps}{   {\it Astron. Astrophys. Suppl.}}
\newcommand{\aapr}{   {\it Astron. Astrophys. Rev.}}
\newcommand{\ag}{     {\it Ann. Geophys.}}
\newcommand{\aj}{     {\it Astron. J.}} 
\newcommand{\apj}{    {\it Astrophys. J.}}
\newcommand{\apjl}{   {\it Astrophys. J. Lett.}}
\newcommand{\apss}{   {\it Astrophys. Space Sci.}} 
\newcommand{\cjaa}{   {\it Chin. J. Astron. Astrophys.}} 
\newcommand{\gafd}{   {\it Geophys. Astrophys. Fluid Dyn.}}
\newcommand{\grl}{    {\it Geophys. Res. Lett.}}
\newcommand{\ijga}{   {\it Int. J. Geomagn. Aeron.}}
\newcommand{\jastp}{  {\it J. Atmos. Solar-Terr. Phys.}} 
\newcommand{\jgr}{    {\it J. Geophys. Res.}}
\newcommand{\mnras}{  {\it Mon. Not. Roy. Astron. Soc.}}
\newcommand{\na}{     {\it New Astronomy}}
\newcommand{\nat}{    {\it Nature}}
\newcommand{\pasp}{   {\it Pub. Astron. Soc. Pac.}}
\newcommand{\pasj}{   {\it Pub. Astron. Soc. Japan}}
\newcommand{\pre}{    {\it Phys. Rev. E}}
\newcommand{\solphys}{{\it Solar Phys.}}
\newcommand{\sovast}{ {\it Soviet  Astron.}} 
\newcommand{\ssr}{    {\it Space Sci. Rev.}}
\newcommand{\caa}{    {\it Chinese Astron. Astrohpys.}} 
\newcommand{\apjs}{   {\it Astrophys. J. Suppl.}}
\newcommand{\lrsp}{{\it Living Rev. Solar Phys.}}

\newcommand{\bv}{\mathbf{v}}
\newcommand{\bB}{\mathbf{B}}

\newcommand{\figdir}{../main/figures/chpt-4/} % where figures are stored


\begin{document}

\baselineskip=18pt

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\setcounter{chapter}{3}


%------------------------------------------------------------------------------
\chapter{Asymmetric waveguides - solar magneto-seismology}
\label{chap: SMS}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
\section{Chapter introduction}
\label{sec: SMS intro}
%------------------------------------------------------------------------------

\color{red}{(STRAIGHT FROM THE INTRO OF ALL + ERD 2018 - PLZ CHANGE)The emerging field of solar magneto-seismology (SMS) has become a crucial tool in developing our understanding of structures in the solar atmosphere. By comparing observational measurements of magnetohydrodynamic (MHD) waves to the wave solutions of inhomogeneous plasma modelling of the medium in which the waves propagate, we can make approximations of traditionally difficult-to-measure plasma parameters such as the magnetic field strength and heat transport coefficient \citep{and_etal09,arr12,dem_etal12}. This in turn equips us with more realistic parameters for numerical simulations and give us a better understanding of conditions that lead to, for example, wave energy dissipation, instability, magnetic reconnection, and heating.

SMS techniques can be categorised as either temporal or spatial seismology. By temporal seismology we refer to methods that estimate a plasma parameter by using the observed frequency, or equivalently the period, of waves. By spatial seismology we refer to methods that estimate a plasma parameter by comparing the observed spatial and/or temporal wave power distribution with the eigenfunctions from a theoretical model.

Several temporal seismology methods have been employed successfully. \cite{ros70} first suggested that the frequency of oscillations, observed through the fluctuation of synchrotron radiation due to the presence of MHD waves, could be used to diagnose background parameters. Further theoretical development has led to more sophisticated temporal methods including local coronal magnetic field strength estimates using standing kink modes in coronal loops by \cite{nak_etal01}, and using slow sausage and kink modes by \cite{erd_etal08}. The ratio of periods of the fundamental and the first harmonic standing kink mode and its dependence on density stratification has also been well studied \citep{ban_etal07,erd_etal14,yu_etal16}.

Spatial seismology techniques have more recently started demonstrating their efficacy in estimating solar parameters. \cite{uch70} estimated the coronal magnetic structure by comparing Moreton wave observations with the theoretical influence that the coronal magnetic field has on the shape of the Moreton wavefront. More recent eigenfunction methods include utilising the anti-node shift of standing modes in a magnetic flux tube to diagnose its inhomogeneous density stratification \citep{erd_etal07,ver_etal07,erd_etal14}.

In the present work, we derive two novel analytical tools for spatial seismology that use an asymmetric slab waveguide to approximate background parameters. This has applications to solar atmospheric structures that are locally slab-like which have been observed to guide MHD oscillations, such as elongated magnetic bright points \citep{yua_etal14}, prominences \citep{arr_etal12}, and light bridge surges \citep{roy73,shi_etal09} (which have also been named light walls by, \textit{e.g.} \citealt{yan_etal15,yan_etal17,zha_etal17}).

This work provides an application of the linear wave analysis of asymmetric magnetic slabs completed by \cite{all_etal17}. A magnetic slab, with non-magnetic, but asymmetric density and temperatures outside the slab has eigenmodes which can be described as either quasi-sausage or quasi-kink. For quasi-sausage (quasi-kink) modes, the oscillations on each slab interface are in anti-phase (phase). They differ in character from traditional (symmetric) sausage and kink modes by their asymmetry about the center of the slab due to the amplitude of oscillation on each interface being unequal caused by the asymmetric external environment. This results in quasi-kink modes not necessarily retaining their cross-sectional area and quasi-sausage modes not necessarily having reflection symmetric about the centre line of the slab. The spatial distribution of these waves across the slab, and therefore the extent to which they are modified from the traditional sausage and kink modes, is dependent on the asymmetric background plasma parameters. Consequently, we can use the spatial distribution of these waves to diagnose the waveguide. This is the focus of the present paper: to derive expressions for proxy parameters that encapsulate this asymmetric spatial distribution and discuss the application to SMS.

Section~\ref{sec: AR} introduces the amplitude ratio diagnostic parameter, Section~\ref{sec: MPS} introduces the minimum perturbation shift diagnostic parameter, and Section~\ref{sec: discussion} discusses the application of these parameters to SMS.}
\color{black}


\subsection{What is solar magneto-seismology?}
As part of a broader set of magnetometry techniques.

\subsection{A brief history}








\textcolor{red}{All of below text needs editing (maybe shortening or putting in an appendix, too?)}
\subsection{Solar atmospheric magnetometry}
The magnetic field plays an integral role in the structure and dynamics of the solar atmosphere. Measuring the strength and direction of the magnetic field vector is therefore important for realistic numerical simulations and a better understanding of active magnetic structures on the Sun. (Maybe we could write more here about why it's important to understand magnetic field in the solar atmosphere)

The first magnetic field measurement techniques involved observing the effect that the field has on the electromagnetic radiation emitted from the plasma, so called \textit{spectral techniques}.

Later, indirect techniques, where we use a different observational proxy to diagnose the magnetic field information, were developed, including magnetic extrapolation and magneto-seismology. With increasing spatial and temporal resolution of solar observations, it is expected that these techniques will become more widely and accurately used.

A description of these techniques is given below.

\subsubsection{Spectral techniques}
\subsubsection{Zeeman effect}
The Zeeman effect is due to magnetic fields distorting the electron orbitals of atoms so that the wavelength of light emitted by electrons relaxing to lower energy levels is modified. This has the effect of splitting the emission lines of plasma in the presence of a magnetic field.

In solar observations, this effect was first observed in 1908 when George Ellery Hale noticed it in the H$\alpha$ spectrum from the 3000 G sunspot magnetic fields. Since then, the Zeeman effect has been the foremost employed solar magnetometry  technique. Since the Doppler broadening scales proportionally to the observed wavelength, $\lambda$, while the Zeeman splitting scales proportionally to $\lambda^2$, the different Zeeman components happen to be completely separated for sufficiently large values of $\lambda$. Infrared is often used to establish observations of Zeeman splitting for this reason.

It has been said that, with the Zeeman effect, “a ruler is sufficient to measure the solar magnetic field” \citep{lan03}. In some sense, this is true. The magnitude of the wavelength splitting of the emission lines is directly related to the strength of the magnetic field in the line-of-sight. To diagnose the direction of the magnetic field, polarimetry and radiative transfer are necessary in any wavelength observation.

Quantum effects must be considered to fully explain the nuances of the effect, in particular, the anomalous Zeeman effect which requires an appreciation of electron spin.

\subsubsection{Hanle effect}
The Hanle rotation effect is not dependent on the length of the path through the magnetic field (which makes it distinct from the Faraday effect). 

Quantum effects must be considered to fully explain the nuances of the effect.

\subsubsection{Indirect techniques}
\subsubsection{Faraday rotation}
When light passes through a magnetic field in a dispersive medium, the polarisation of the light is rotated proportionally to the strength of the magnetic field and the length of the path in the medium within the magnetic field. This is known as Faraday rotation. By observing light from a distant star of known polarisation as it passes through the rarefied solar corona and measuring the corresponding polarisation rotation, we can make an indirect measurement of the coronal magnetic field.

By observing the radiation from a background star with known radiation spectrum as it passes behind the outer corona, a measurement of the rotation of the polarisation of the light, and therefore a measurement of the line-of-sight magnetic field can be made.


\subsubsection{Photospheric extrapolation}
Currently, our measurements of the vector field in the $10^6$ K corona of the quiet Sun comes almost entirely from extrapolation of photospheric magnetic field measurements. The photospheric magnetic field (whose magnitude and direction can be measured with low uncertainty using observations of Zeeman splitting of spectral lines) is used as a lower boundary condition used to solve a set of differential equations for the magnetic field.

For quasi-stationary solar structures, such that the magnetostatic approximations is valid, balance between the Lorentz force, pressure gradient force, and gravity in the solar atmosphere can be written as
\begin{equation}
\mathbf{j} \times \mathbf{B} - \nabla p - \rho \mathbf{g} = 0.
\end{equation}
In the solar corona, the plasma is of low beta ($\beta \ll 1$), and for regions of vertical extent smaller than $H/\beta$, where $H$ is the pressure scale-height, the force balance simplifies to 
\begin{equation}
\mathbf{j} \times \mathbf{B} = 0,
\end{equation}
\textit{i.e.} the magnetic field is \textit{force-free}.

The simplest way to achieve a force-free magnetic field is to take $\mathbf{j} = 0$, describing a current-free (potential) field. For this simple type of field, there exists a magnetic scalar potential, $\phi = \phi(\mathbf{x})$, such that $\mathbf{B} = \nabla\phi$. Then, from the solenoidal condition, the scalar potential satisfies
\begin{equation}
\nabla^2 \phi = 0.
\end{equation}
This equation is solved using a Green's function method or an eigenfunction expansion method with the observed photospheric boundary condition to extrapolate the photospheric magnetic field into the corona.

A more sophisticated way to ensure a force-free magnetic field is to take the magnetic field parallel to the electric current, that is
\begin{equation}
\nabla \times \mathbf{B} = \alpha \mathbf{B},
\label{alpha1}
\end{equation}
where $\alpha$ is the proportionality between the magnetic field and the current. Taking the divergence of this equation gives us
\begin{equation}
\mathbf{B} \cdot \nabla\alpha = 0,
\label{alpha2}
\end{equation}
since $\nabla \cdot \mathbf{B} = 0$. From this, it follows that $\alpha$ is constant along each field line. When $\alpha$ is constant, the extrapolation is known as \textit{linear force-free}; if not, it is known as \textit{nonlinear force-free}.

The force-free equations (Equations~\eqref{alpha1} and~\eqref{alpha2}) must be solved numerically in all but the simplest of cases. Even when taking a simple upper-boundary condition that the magnetic field is negligible far from the solar surface, the problem is mathematically ill-posed (why?), in that a small change in the imposed photospheric boundary condition results in a large change in the extrapolated field \citep{low_etal90}. This is problematic due to the necessary uncertainty in the photospheric magnetic field measurements.


\subsubsection{Magneto-seismology}
Perpetual bubbling, erupting, and turbulent buffeting of plasma drive ubiquitous magneto-acoustic waves throughout the solar atmosphere. The topology and strength of the magnetic field determines the type  and their properties of waves present in a given structure. Therefore, by observing these waves and solving an inverse problem, it is possible to make a diagnosis of magnetic field information - a technique known as \textit{solar magneto-seismology} (SMS).

Since early observations of these waves were made in coronal loops at the end of the 20th century, further observations have shown their ubiquity across almost all magnetic structures in the solar atmosphere, including prominences, sunspots, fibrils, and light walls. This makes SMS a promising avenue for advancing our understanding of the coronal magnetic field.

Observations of MHD oscillations can give us both temporal and spatial parameters. For example, we can  
\newcommand{\tb}{\textcolor{black}}
\tikzstyle{format} = [draw, rounded corners=.055cm, fill=cyan!20]
\tikzstyle{format2} = [draw, rounded corners=.055cm, fill=red!20]
\begin{figure}
	\begin{tikzpicture}[node distance=1.8cm and 3.3cm, auto, >=latex, align = flush center, ultra thick, on grid=true, font=\small]
	% We need to set at bounding box first. Otherwise the diagram
	% will change position for each frame.
	\path[use as bounding box] (-1.7,-4.1) rectangle (10,2);
	\path node[format] (obs) {
		Observations};
	\path node[below= of obs] (ghost) {};
	\path node[format, below= of ghost] (phys) {
		Physical \\ 
		understanding};
	
	\path node[format2, below right= of obs] (ep) {
		Equilibrium \\ 
		parameters};
	\path (ep) edge[<-] (obs);
	\path node[format, above right= of obs] (wp) {
		Wave \\ 
		parameters}
	edge[<-] (obs);
	
	\path node[format, right= of wp] (tp) {
		Temporal \\ 
		parameters}
	edge[<-] (wp);
	\path node[format, below= of tp] (sp) {
		Spatial \\ 
		parameters}
	edge[<-] (wp)
	edge[<-] (ep);  
	
	\path node[format, right= of phys] (em) {
		Equilibrium \\ 
		models};
	\path (em) edge[<-] (phys);
	
	\path node[format, right= of em] (eig) {
		Eigenmodes}
	edge[<-] (em);
	
	\path node[format, right= of sp] (ts) {
		Temporal \\
		magneto-seismology};
	\path (ts) edge[<-] (tp);
	\node at (6.6,-2) (ghost2) {};
	\draw [->] (ghost2.center) -- (ts);
	\draw (ghost2.center) -- (eig);
	\path node[format, below right= of sp] (ss) {
		Spatial \\
		magneto-seismology};
	\draw [->] (eig) -- (ss);
	\path (ss) edge[<-] (sp);
	
	
	\path (ts) edge[->] (ep);
	\path (ss) edge[->] (ep);
	
	\end{tikzpicture}
	\caption{A flow chart describing the method of solar magneto-seismology.}
\end{figure}

Some of the major advancements in temporal magneto-seismology:
\begin{itemize}
	\item Rosenberg, 1970: Pulsations in synchrotron radiation caused by MHD waves,
	\item Zeitsev and Stepanov, 1975: Pulsations of type IV solar radio emission due to flux tube oscillations,
	\item Roberts et al., 1984: coronal seismology discussion,
	\item Tandberg Hanssen et al., 1995: Prominence seismology,
	\item Nakariakov and Ofman, 2001: Period of standing kink mode used to diagnose magnetic field strength,
	\item Goossens et al., 2002: Damping time scales (assuming exponential damping) used to estimate density variation across loop (?).
	\item Andries et al., 2005: Density stratification deduced from period ratio of first two standing kink harmonics,
	\item Erdelyi and Taroyan, 2008: Slow standing modes in loops,
	\item Pascoe et al., 2013: Gaussian and exponential damping of kink modes to estimate loop density,
	\item Magyar et al., 2017: Global dynamic coronal seismology - i.e. diagnosing the magnetic field strength changing in time and across a large portion of the corona.
\end{itemize}
Some of the major advancements in spatial magneto-seismology:
\begin{itemize}
	\item Uchida, 1970: Moreton wavefronts,
	\item Verth et al., 2007: Anti-node shift due to density stratification along the loop (e.g. higher density at food points).
\end{itemize}


\subsubsection{Future techniques}
\subsubsection{In-situ measurements}
NASA Parker Probe.

\subsection{Application and difficulties}
In the photosphere and chromosphere, the strength of both the line-of-sight and plane-of-sky magnetic field components (equivalently, the direction and magnitude of the magnetic field vector) can be made with low uncertainty using the Zeeman splitting of the spectral lines observed.

It is always difficult, and often impossible, to ascertain any magnetic field information in the corona. This is due to the fact that, although it dominates other forces involved, the magnetic field is of low absolute strength, and the plasma is extremely sparse. (WHY?)


\subsection{OTHER DETAILS TO ADD ABOVE}
From Aschwanden's book: "Above active regions, the magnetic field can sometimes be inferred from the change in sign and amplitude of the circular polarization when the microwave radiation passes through a quasi-transverse (QT) region (e.g., Ryabov et al. 1999). In weak-field regions far away from sunspots, the coronal field can also be probed by measuring the Faraday rotation (Alissandrakis  and Chiuderi-Drago 1995). Alternative methods to measure the coronal magnetic field have also been demonstrated by using the Fe XIII line in the infrared (Lin et al. 2000) or the Hanle effect (Stenflo 1994)."


\subsection{General techniques}
\subsubsection{Bayesian inversion}
Arregui and Asensio Ramos, 2011, developed a Bayesian scheme to reduce uncertainty in magnetic field measurements by giving accurate likelihood values on each solution from the multi-valued inversion procedure.


\subsection{Solar magneto-seismology using asymmetric waves}

\textcolor{red}{Lots of progress with temporal SMS, not much with spatial SMS. Prev sections show that if you change the background parameters, the asymmetry changes. Therefore, we can measure the asymmetry and invert the background parameters. How can we quantify this asymmetry? Amplitude ratio and minimum perturbation shift.}


%------------------------------------------------------------------------------
\section{Amplitude Ratio}
\label{sec: AR}
%------------------------------------------------------------------------------

The aim of this section is to derive an expression for the ratio of the oscillation amplitude on each interface of an asymmetric magnetic slab in terms of the wave parameters and plasma parameters of the system, then demonstrate how this parameter can be utilised to diagnose background parameters. We focus on estimating the Alfv\'{e}n speed since it is the the most difficult of all our background parameters to measure using traditional methods. We do this by first deriving expressions for the eigenfunctions\footnote{That is, the distribution of the oscillation amplitude across the waveguide.} of quasi-sausage and quasi-kink modes, using them to derive expressions for the Amplitude Ratio, and then by making suitable approximations, we can solve the inverse problem for the Alfv\'{e}n speed. Numerical inversion procedures for the Amplitude Ratio Method are discussed in Section~\ref{sec: numerical inversion} 

\subsection{Deriving an expression for the Amplitude Ratio} \label{sec: amp ratio}

Consider an asymmetric magnetic slab in a non-magnetic environment, as studied in Section~\ref{sec: EVP non-mag} and by \cite{all_etal17}. In this section, we denote the Alfv\'{e}n speed inside the slab as $v_\textrm{A}$ rather than $v_{A0}$ for brevity because it is the only Alfv\'{e}n speed in the system since we have let the external plasma be non-magnetic.

In Section~\ref{sec: EVP non-mag}, it was shown that trapped magneto-acoustic modes propagating along an asymmetric magnetic slab have velocity perturbation in the $x$-direction given by $v_x(x,y,z,t) = \widehat{v}_x(x)e^{i(kz-\omega t)}$, where $\omega$ and $k$ are the angular frequency and wavenumber, and
\begin{equation}
\hat{v}_x(x)=
\begin{cases}
A(\cosh{m_1x} + \sinh{m_1x}) & \text{if } x < -x_0, \\
B\cosh{m_0x} + C\sinh{m_0x} & \text{if } |x| \leq x_0, \\
D(\cosh{m_2x} - \sinh{m_2x}) & \text{if } x > x_0, \label{vsoln}
\end{cases}
\end{equation}
where
\begin{equation}
m_0^2 = \frac{(k^2v_\textrm{A}^2 - \omega^2)(k^2c_0^2 - \omega^2)}{(c_0^2 + v_\textrm{A}^2)(k^2c_{T0}^2-\omega^2)}, \qquad c_{T0}^2 = \frac{c_0^2v_\textrm{A}^2}{c_0^2 + v_\textrm{A}^2}, \label{m0}
\end{equation}
\begin{equation}
m_j^2 = k^2 - \frac{\omega^2}{c_j^2}, \quad \text{for $j = 1, 2$,} \label{m1,2}
\end{equation}
and $A, B, C$, and $D$ are arbitrary constants (with respect to $x$). Therefore, to derive expressions for the eigenfunctions, we need to determine these constants. They can be determined, to within one degree of freedom, using the boundary conditions of continuity in total pressure and transversal velocity component across the slab boundaries at $x = \pm x_0$. Applying these four boundary conditions retrieves four coupled linear homogeneous algebraic equations in the four unknowns, namely
\begin{equation}
\left(
\begin{matrix}
c_1 - s_1 &-c_0                       &s_0                        &0 \\
0       &c_0                        &s_0                        &s_2 - c_2 \\
\Lambda_1(c_1 - s_1)       &\Lambda_0s_0 &-\Lambda_0c_0  &0 \\
0       &\Lambda_0s_0                          &\Lambda                   _0c_0 &-\Lambda_2(s_2 - c_2)
\end{matrix}
\right)
\left(
\begin{matrix}
A \\
B \\
C \\
D
\end{matrix}
\right)
=
\left(
\begin{matrix}
0 \\
0 \\
0 \\
0
\end{matrix}
\right),
\label{coefmatrix}
\end{equation}
where
\begin{equation}
\Lambda_0 = -\frac{i\rho_0(k^2v_\textrm{A}^2 - \omega^2)}{m_0\omega}, \quad \Lambda_1 = \frac{i\rho_1\omega}{m_1}, \quad \text{and} \quad \Lambda_2 = \frac{i\rho_2\omega}{m_2}, \label{Lambdas}
\end{equation}
and $c_i = \cosh{m_ix_0}$ and $s_i = \sinh{m_ix_i}$, for $i = 0, 1, 2$. Ensuring that this matrix has a vanishing determinant gives us the dispersion relation,
\begin{equation}
(\Lambda_0c_0 + \Lambda_2s_0)(\Lambda_0s_0 + \Lambda_1c_0) + (\Lambda_0c_0 + \Lambda_1s_0)(\Lambda_0s_0 + \Lambda_2c_0) = 0. \label{disp rel}
\end{equation}
By satisfying this relation, we gain one degree of freedom in the system of Equations~\eqref{coefmatrix}, which leaves one of the constants $B$ or $C$ arbitrary. This leads to two types of solution: \textit{quasi-sausage} and \textit{quasi-kink} modes.

Firstly, for quasi-sausage modes, by letting $C$ be arbitrary the other constants $A$, $B$, and $D$ can be determined as
\begin{align}
A =& \frac{1}{c_1 - s_1}(Bc_0 - Cs_0), \label{constA C} \\ 
D =& \frac{1}{c_2 - s_2}(Bc_0 + Cs_0), \label{constD C}
\end{align}
where
\begin{equation}
B = \frac{\Lambda_0c_0 + \Lambda_1s_0}{\Lambda_0s_0 + \Lambda_1c_0}C = -\frac{\Lambda_0c_0 + \Lambda_2s_0}{\Lambda_0s_0 + \Lambda_2c_0}C. \label{constB C}
\end{equation}
The second formulation of $B$ in Equation~\eqref{constB C} is found by utilising the dispersion relation, Equation~\eqref{disp rel}. A substitution of these values, using the first form of $B$ in Equation~\eqref{constB C}, into the velocity solution, Equation~\eqref{vsoln}, evaluated at the slab boundaries, yields
\begin{align}
\hat{v}_x(x_0) =& Bc_0 + Cs_0 = \frac{2\Lambda_1 + \Lambda_0\left(\tau_0 + \frac{1}{\tau_0}\right)}{\Lambda_0 + \Lambda_1\frac{1}{\tau_0}}Cc_0, \label{vx_01 C} \\
\hat{v}_x(-x_0) =& Bc_0 - Cs_0 = \frac{\Lambda_0}{\Lambda_0 + \Lambda_1\frac{1}{\tau_0}}C/s_0, \label{v-x_01 C}
\end{align}
where $\tau_0 = \tanh{m_0x_0}$. Similarly, using the second form of $B$ in Equation~\eqref{constB C} yields
\begin{align}
\hat{v}_x(x_0) =& \frac{-\Lambda_0}{\Lambda_0 + \Lambda_2\frac{1}{\tau_0}}C/s_0, \label{vx_02 C} \\
\hat{v}_x(-x_0) =& \frac{-2\Lambda_2 - \Lambda_0\left(\tau_0 + \frac{1}{\tau_0}\right)}{\Lambda_0 + \Lambda_2\frac{1}{\tau_0}}Cc_0. \label{v-x_02 C}
\end{align}
These forms are equivalent. Notice that the horizontal velocity perturbation amplitude, $\hat{v}_x$, is, more precisely, the \emph{signed} amplitude, where a positive (negative) value indicates perturbation in the positive (negative) $x$-direction. This will be important for the inversion procedure.

Secondly, for quasi-kink modes, by letting $B$ be arbitrary, the other constants $A$, $C$, and $D$ can be determined in terms of $B$ as
\begin{align}
A =& \frac{1}{c_1 - s_1}(Bc_0 - Cs_0), \label{constA B} \\ 
D =& \frac{1}{c_2 - s_2}(Bc_0 + Cs_0), \label{constD B}
\end{align}
where
\begin{equation}
C = \frac{\Lambda_0s_0 + \Lambda_1c_0}{\Lambda_0c_0 + \Lambda_1s_0}B = -\frac{\Lambda_0s_0 + \Lambda_2c_0}{\Lambda_0c_0 + \Lambda_2s_0}B. \label{constB B}
\end{equation}
A substitution of these values, using the first form of $C$ in Equation~\eqref{constB B}, into Equation~\eqref{vsoln}, evaluated at the slab boundaries, yields
\begin{align}
\hat{v}_x(x_0) =& \frac{2\Lambda_1 + \Lambda_0\left(\tau_0 + \frac{1}{\tau_0}\right)}{\Lambda_0 + \Lambda_1\tau_0}Bs_0, \label{vx_01 B} \\
\hat{v}_x(-x_0) =& \frac{\Lambda_0}{\Lambda_0 + \Lambda_1\tau_0}B/c_0. \label{v-x_01 B}
\end{align}
Using the second form of $C$ in Equation~\eqref{constB B} yields
\begin{align}
\hat{v}_x(x_0) =& \frac{\Lambda_0}{\Lambda_0 + \Lambda_2\tau_0}B/c_0, \label{vx_02 B} \\
\hat{v}_x(-x_0) =& \frac{2\Lambda_2 + \Lambda_0\left(\tau_0 + \frac{1}{\tau_0}\right)}{\Lambda_0 + \Lambda_2\tau_0}Bs_0. \label{v-x_02 B}
\end{align}

\begin{figure}
	\makebox[\textwidth][c]{
		\subfloat[]{\scalebox{0.9}{
				\begin{tikzpicture}
				\draw [->] (1,0) -- (6,0);
				
				\shade[bottom color=lightgray,top color=white, opacity=0.7] (1.75,2) to [out=-90,in=90] (2.25,0.75) to (4.5,0.75) to [out=90,in=-90] (5.5,2) to (1.75,2);
				
				\shade[bottom color=white,top color=lightgray, opacity=0.7] (2.25,0.75) to (4.5,0.75) to [out=-90,in=90] (5.5,-0.5) to (1.75,-0.5) to [out=90,in=-90] (2.25,0.75);
				
				\draw [thick] (1.75,2) to [out=-90,in=90] (2.25,0.75) to [out=-90,in=90] (1.75,-0.5);
				\draw [thick, dashed, opacity=0.5] (4.5,2) to [out=-90,in=90] (5.5,0.75) to [out=-90,in=90] (4.5,-0.5);
				
				\draw [thick, red, -stealth] (2.375,-0.5) to [out=90,in=-90] (2.625, 0.75) to [out=90,in=-90] (2.375,2);
				\draw [thick, red, -stealth] (3,-0.5) to [out=90,in=-90] (3, 0.75) to [out=90,in=-90] (3,2);
				\draw [thick, red, -stealth] (3.625,-0.5) to [out=90,in=-90] (3.375, 0.75) to [out=90,in=-90] (3.625,2);
				\draw [thick, red, -stealth] (4.25,-0.5) to [out=90,in=-90] (3.75, 0.75) to [out=90,in=-90] (4.25,2);
				\draw [thick, red, -stealth] (4.875,-0.5) to [out=90,in=-90] (4.125, 0.75) to [out=90,in=-90] (4.875,2);
				
				\draw [thick, dashed, opacity=0.5] (2.25,2) to [out=-90,in=90] (1.75,0.75) to [out=-90,in=90] (2.25,-0.5);
				\draw [thick] (5.5,2) to [out=-90,in=90] (4.5,0.75) to [out=-90,in=90] (5.5,-0.5);
				
				% % % % % % % % % % % % % % % % % % % % % % % % % %
				
				%\draw [->] (0,0) -- (0,2);
				
				%\node at (1,1) {$\rho_1$};
				%\node at (6,1) {$\rho_2$};
				%\node [right] at (2.95,1.3) {$\rho_0$};
				
				\draw [-] (1.75, 2.1) to [out=90, in=-90] (1.875, 2.3) to [out=-90, in=90] (2, 2.1);
				\draw [-] (5, 2.1) to [out=90, in=-90] (5.25, 2.3) to [out=-90, in=90] (5.5, 2.1);
				
				\node [above] at (1.875,2.3) {$\widehat{\xi}_x(-x_0)$};
				\node [above] at (5.25, 2.3) {$\widehat{\xi}_x(x_0)$};
				
				\small
				\node [below] at (2,-0.5) {$-x_0$};
				\node [below] at (5,-0.5) {$x_0$};
				
				%\node [left] at (0,2) {$z$};
				\node [below] at (6,0) {$x$};
				\draw [-] (2,-0.5) -- (2,2);
				\draw [-] (5,-0.5) -- (5,2);
				\end{tikzpicture} 
			}\label{fig: RA saus}}
		
		
		\subfloat[]{\scalebox{0.9}{
				\begin{tikzpicture}
				\draw [->] (1,0) -- (6,0);
				
				\shade[bottom color=lightgray,top color=white, opacity=0.7] (1.5,2) to [out=-90,in=90] (2.5,0.75) to (5.25,0.75) to [out=90,in=-90] (4.75,2) to (1.5,2);
				
				\shade[bottom color=white,top color=lightgray, opacity=0.7] (2.5,0.75) to (5.25,0.75) to [out=-90,in=90] (4.75,-0.5) to (1.5,-0.5) to [out=90,in=-90] (2.5,0.75);
				
				\draw [thick] (1.5,2) to [out=-90,in=90] (2.5,0.75) to [out=-90,in=90] (1.5,-0.5);
				\draw [thick] (4.75,2) to [out=-90,in=90] (5.25,0.75) to [out=-90,in=90] (4.75,-0.5);
				
				%\draw [thick, red, -stealth] (2.0417,-0.5) to [out=90,in=-90] (2.9583, 0.75) to [out=90,in=-90] (2.0417,2);
				%\draw [thick, red, -stealth] (2.5833,-0.5) to [out=90,in=-90] (3.4167, 0.75) to [out=90,in=-90] (2.5833,2);
				%\draw [thick, red, -stealth] (3.125,-0.5) to [out=90,in=-90] (3.875, 0.75) to [out=90,in=-90] (3.125,2);
				%\draw [thick, red, -stealth] (3.6667,-0.5) to [out=90,in=-90] (4.3333, 0.75) to [out=90,in=-90] (3.6667,2);
				%\draw [thick, red, -stealth] (4.2083,-0.5) to [out=90,in=-90] (4.7917, 0.75) to [out=90,in=-90] (4.2083,2);
				
				\draw [thick, red, -stealth] (2.0417,-0.5) to [out=90,in=-90] (2.9583, 0.75) to [out=90,in=-90] (2.0417,2);
				\draw [thick, red, -stealth] (2.5833,-0.5) to [out=90,in=-90] (3.32, 0.75) to [out=90,in=-90] (2.5833,2);
				\draw [thick, red, -stealth] (3.125,-0.5) to [out=90,in=-90] (3.7, 0.75) to [out=90,in=-90] (3.125,2);
				\draw [thick, red, -stealth] (3.6667,-0.5) to [out=90,in=-90] (4.15, 0.75) to [out=90,in=-90] (3.6667,2);
				\draw [thick, red, -stealth] (4.2083,-0.5) to [out=90,in=-90] (4.7, 0.75) to [out=90,in=-90] (4.2083,2);
				
				\draw [thick, dashed, opacity=0.5] (2.5,2) to [out=-90,in=90] (1.5,0.75) to [out=-90,in=90] (2.5,-0.5);
				\draw [thick, dashed, opacity=0.5] (5.25,2) to [out=-90,in=90] (4.75,0.75) to [out=-90,in=90] (5.25,-0.5);
				
				% % % % % % % % % % % % % % % % % % % % % % % % % %
				
				\draw [-] (1.5, 2.1) to [out=90, in=-90] (1.75, 2.3) to [out=-90, in=90] (2., 2.1);
				\draw [-] (4.75, 2.1) to [out=90, in=-90] (4.875, 2.3) to [out=-90, in=90] (5., 2.1);
				
				\node [above] at (1.75,2.3) {$\widehat{\xi}_x(-x_0)$};
				\node [above] at (4.875, 2.3) {$\widehat{\xi}_x(x_0)$};
				
				\small
				\node [below] at (2,-0.5) {$-x_0$};
				\node [below] at (5,-0.5) {$x_0$};
				
				%\node [left] at (0,2) {$z$};
				\node [below] at (6,0) {$x$};
				\draw [-] (2,-0.5) -- (2,2);
				\draw [-] (5,-0.5) -- (5,2);
				\end{tikzpicture} 
			}\label{fig: RA kink}}}
	\caption{Illustration of the difference in amplitude of oscillation on each boundary of the slab for~\protect\subref{fig: RA saus}~quasi-sausage and~\protect\subref{fig: RA kink}~quasi-kink modes.}
	\label{fig: RA}
\end{figure}

We now define the \emph{amplitude ratio}, $R_\textrm{A} := \hat{\xi}_x(x_0) / \hat{\xi}_x(-x_0)$, as the ratio of the amplitude of oscillation of the left interface ($x = x_0$) to that of the right interface ($x = -x_0$) (see Figure~\ref{fig: RA}). Given that ${\hat{\xi}_x(x) = i\hat{v}_x(x) / \omega}$, we also have $R_\textrm{A} = \hat{v}_x(x_0) / \hat{v}_x(-x_0)$. Firstly, using Equations~\eqref{v-x_01 C} and~\eqref{vx_02 C}, the amplitude ratio for quasi-sausage modes is
\begin{align}
R_A &= -\frac{\Lambda_0 + \Lambda_1\frac{1}{\tau_0}}{\Lambda_0 + \Lambda_2\frac{1}{\tau_0}} \notag \\
&= -\frac{\rho_1m_2}{\rho_2m_1}\left[\frac{(k^2v_\textrm{A}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2m_0\frac{1}{\tanh{m_0x_0}}}{(k^2v_\textrm{A}^2 - \omega^2)m_2\frac{\rho_0}{\rho_2} - \omega^2m_0\frac{1}{\tanh{m_0x_0}}}\right]. \label{cross-slab ratio saus}
\end{align}
Using Equations~\eqref{v-x_01 B} and~\eqref{vx_02 B}, the corresponding expression for quasi-kink modes can be obtained, namely
\begin{align}
R_\textrm{A} &= \frac{\Lambda_0 + \Lambda_1\tau_0}{\Lambda_0 + \Lambda_2\tau_0} \notag \\
&= \frac{\rho_1m_2}{\rho_2m_1}\left[\frac{(k^2v_\textrm{A}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2m_0\tanh{m_0x_0}}{(k^2v_\textrm{A}^2 - \omega^2)m_2\frac{\rho_0}{\rho_2} - \omega^2m_0\tanh{m_0x_0}}\right]. \label{cross-slab ratio kink}
\end{align}
As expected, Equations~\eqref{cross-slab ratio saus} and~\eqref{cross-slab ratio kink} reduce to $R_\textrm{A} = -1$ and $R_\textrm{A} = 1$ for sausage and kink modes, respectively, when the slab is symmetric.

To obtain an approximation for the Alfv\'{e}n speed analytically, an approximation such as these must be applied. The following subsections give the analytical inversion for the Alfv\'{e}n speed, $v_\textrm{A}$, of equations~\eqref{cross-slab ratio saus} and~\eqref{cross-slab ratio kink} under the thin slab, wide slab, incompressible plasma, and low-beta approximations. A numerical inversion procedure that requires no further approximation is discussed in Section~\ref{sec: numerical inversion}. Note that we restrict the parameter inversions to surface modes only, thereby omitting body modes, because the eigenfrequencies and eigenfunctions of body modes are not significantly effected by asymmetry in the external plasma (see Section~\ref{sec: EVP non-mag}) so they are not useful for parameter inversion.


\subsection{Thin slab approximation} \label{sec: AR thin slab}
For surface modes in the thin slab approximation, $kx_0 \ll 1$, \cite{rob81b} showed that $m_0x_0 \ll 1$. Therefore, to quadratic order, $\tanh{m_0x_0} \approx m_0x_0$, and the amplitude ratio for a quasi-sausage surface mode in a thin slab reduces to
\begin{equation}
R_\textrm{A} = -\frac{\rho_1m_2}{\rho_2m_1}\left[\frac{(k^2v_\textrm{A}^2 - \omega^2)m_1x_0\frac{\rho_0}{\rho_1} - \omega^2}{(k^2v_\textrm{A}^2 - \omega^2)m_2x_0\frac{\rho_0}{\rho_2} - \omega^2}\right], 
\end{equation}
which can be rearranged to give the analytical expression
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2} \left[1 + \frac{1}{x_0} \left(\frac{R_\textrm{A}\frac{\rho_2}{\rho_0m_2} + \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} + 1}\right)\right].
\end{equation}
The amplitude ratio for a thin slab quasi-kink surface mode reduces to
\begin{equation}
R_\textrm{A} = \frac{\rho_1m_2}{\rho_2m_1} \left[\frac{(k^2v_\textrm{A}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2m_0^2x_0}{(k^2v_\textrm{A}^2 - \omega^2)m_2\frac{\rho_0}{\rho_2} - \omega^2m_0^2x_0}\right], 
\end{equation}
which can be rearranged to give the analytical expression
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2} \left[\frac{c_0^2}{c_0^2 - \frac{\omega^2}{k^2}} + k^2x_0\left(\frac{R_\textrm{A}\frac{\rho_2}{\rho_0m_2} - \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} - 1}\right)\right]. \label{AR soln kink thin}
\end{equation}

In a thin asymmetric slab, the fast quasi-kink surface mode degenerates due to a cut-off by the external sound speeds becoming distinct \citep{all_etal17} and the slow quasi-kink surface mode has a phase speed that approaches zero in the thin slab limit (see Section~\ref{sec: thin slab}). Therefore, to a good approximation the phase speed is much less than the internal sound speed ($\omega/k \ll c_0$) therefore Equation~\eqref{AR soln kink thin} simplifies to
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2} \left[1 + k^2x_0\left(\frac{R_\textrm{A}\frac{\rho_2}{\rho_0m_2} - \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} - 1}\right)\right]. \label{AR soln kink thin simplified}
\end{equation}

\subsection{Wide slab approximation} \label{sec: AR wide slab}
The wide slab approximation applies when the slab width is much larger than the wavelength, that is when $kx_0 \gg 1$. In Section~\ref{sec: wide slab}, we showed that the surface mode solutions of a wide asymmetric slab are just the surface modes that propagate along each interface independently.

This is analogous to the mechanical example introduced in Section~\ref{sec: mechanical example}. When the two masses are decoupled by removing the middle spring, equivalently setting $k_0 = 0$, each mass oscillates independently at the natural frequency of that side of the spring-mass system (Figure~\ref{fig: wide slab mechanical analogy}). This decoupling provides a good analogy to the wide slab limit for the magnetic slab. In a wide slab, each interface is effectively \textit{decoupled} and oscillates at its own natural frequency, independent of the other interface. Given that we are considering magneto-acoustic waves, there are two restoring forces, the magnetic tension force and the pressure gradient force, which means that each independent interface has two natural frequencies, corresponding to the fast and slow magneto-acoustic modes. With this understanding of the modes in the wide slab limit, the amplitude ratio, $R_\textrm{A}$, is either $0$ or $\pm\infty$, depending on which interface the wave is propagating and is therefore not useful for magneto-seismology.

\begin{figure}
	\makebox[\textwidth][c]{
		\subfloat[Coupled equilibrium]{\scalebox{0.9}{
				\begin{tikzpicture}
				\filldraw[pattern=north east lines] (0,-0.5) -| (-0.2,0.5) -| (0,-0.5);
				\filldraw[pattern=north east lines] (6,-0.5) -| (6.2,0.5) -| (6,-0.5);
				\draw[Spring, line width=2] (0,0) -- (2,0);
				\draw[Spring, thin] (2,0) -- (4,0);
				\draw[Spring, line width=1] (4,0) -- (6,0);
				
				\draw [dashed] (2,1) -- (2,-1);
				\draw [dashed] (4,1) -- (4,-1);
				
				\draw (2,0) node [fill=red,circle,scale=0.8] {};
				\draw (4,0) node [fill=red,circle,scale=0.8] {};
				
				\Large
				\draw (1,0.6) node [] {$k_1$};
				\draw (3,0.6) node [] {$k_0 \neq 0$};
				\draw (5,0.6) node [] {$k_2$};
				\end{tikzpicture}
		}}
		
		\subfloat[Uncoupled equilibrium]{\scalebox{0.9}{
				\begin{tikzpicture}
				\filldraw[pattern=north east lines] (0,-0.5) -| (-0.2,0.5) -| (0,-0.5);
				\filldraw[pattern=north east lines] (6,-0.5) -| (6.2,0.5) -| (6,-0.5);
				\draw[Spring, line width=2] (0,0) -- (2,0);
				%\draw[Spring, thin] (2,0) -- (4,0);
				\draw[Spring, line width=1] (4,0) -- (6,0);
				
				\draw [dashed] (2,1) -- (2,-1);
				\draw [dashed] (4,1) -- (4,-1);
				
				\draw (2,0) node [fill=red,circle,scale=0.8] {};
				\draw (4,0) node [fill=red,circle,scale=0.8] {};
				
				\Large
				\draw (1,0.6) node [] {$k_1$};
				\draw (3,0.6) node [] {$k_0 = 0$};
				\draw (5,0.6) node [] {$k_2$};
				\end{tikzpicture}
	}}}
	
	\makebox[\textwidth][c]{
		\subfloat[Uncoupled left oscillation]{\scalebox{0.9}{
				\begin{tikzpicture}
				\filldraw[pattern=north east lines] (0,-0.5) -| (-0.2,0.5) -| (0,-0.5);
				\filldraw[pattern=north east lines] (6,-0.5) -| (6.2,0.5) -| (6,-0.5);
				\draw[Spring, line width=2] (0,0) -- (1.5,0);
				%\draw[Spring, thin] (2,0) -- (4,0);
				\draw[Spring, line width=1] (4,0) -- (6,0);
				
				\draw [dashed] (2,1) -- (2,-1);
				\draw [dashed] (4,1) -- (4,-1);
				
				\draw (1.5,0) node [fill=red,circle,scale=0.8] {};
				\draw (4,0) node [fill=red,circle,scale=0.8] {};
				
				\Large
				\draw (1,0.6) node [] {$k_1$};
				\draw (3,0.6) node [] {$k_0 = 0$};
				\draw (5,0.6) node [] {$k_2$};
				\end{tikzpicture}
		}}
		
		\subfloat[Uncoupled right oscillation]{\scalebox{0.9}{
				\begin{tikzpicture}
				\filldraw[pattern=north east lines] (0,-0.5) -| (-0.2,0.5) -| (0,-0.5);
				\filldraw[pattern=north east lines] (6,-0.5) -| (6.2,0.5) -| (6,-0.5);
				\draw[Spring, line width=2] (0,0) -- (2,0);
				%\draw[Spring, thin] (2,0) -- (4,0);
				\draw[Spring, line width=1] (3,0) -- (6,0);
				
				\draw [dashed] (2,1) -- (2,-1);
				\draw [dashed] (4,1) -- (4,-1);
				
				\draw (2,0) node [fill=red,circle,scale=0.8] {};
				\draw (3,0) node [fill=red,circle,scale=0.8] {};
				
				\Large
				\draw (1,0.6) node [] {$k_1$};
				\draw (3,0.6) node [] {$k_0 = 0$};
				\draw (5,0.6) node [] {$k_2$};
				\end{tikzpicture}
	}}}
	\caption{Mechanical example showing weak and zero coupling between the masses. This provides an analogy to the wide slab approximation of an asymmetric magnetic slab, in which case the interfaces on each side of the slab oscillate independently.}
	\label{fig: wide slab mechanical analogy}
\end{figure}


\subsection{Incompressible Approximation} \label{sec: AR incomp}

If the plasma is incompressible, the sound speeds become unbounded, so that $m_j \approx k$ for $j = 0, 1, 2$. Under this approximation, the amplitude ratios for quasi-sausage modes (top) and quasi-kink modes (bottom) reduce to
\begin{align}
R_\textrm{A} &= \left(\substack{- \\ +}\right) \frac{\rho_1}{\rho_2} \left[ \frac{(k^2v_\textrm{A}^2 - \omega^2)k\frac{\rho_0}{\rho_1} - \omega^2k \left(\begin{matrix} \coth \\ \tanh \end{matrix}\right)(kx_0)}{(k^2v_\textrm{A}^2-\omega^2)k\frac{\rho_0}{\rho_2}-\omega^2k \left(\begin{matrix} \coth \\ \tanh \end{matrix}\right)(kx_0)} \right].
\end{align}
These equations have solutions for $v_\textrm{A}$ given by
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2} \left[ 1 + \left( \frac{R_\textrm{A} \frac{\rho_2}{\rho_0} \left(\substack{+ \\ -}\right) \frac{\rho_1}{\rho_0}}{R_\textrm{A} \left(\substack{+ \\ -}\right) 1} \right) \left(\begin{matrix} \coth \\ \tanh \end{matrix}\right) (kx_0)\right].
\end{equation}


\subsection{Low-Beta Approximation} \label{sec: AR low-beta}

For a low-beta plasma ($\beta = 2\mu_0p_0/B_0^2 \ll 1$), the magnetic pressure dominates the kinetic plasma pressure and the Alfv\'{e}n speed, $v_\textrm{A}$, dominates the sound speed, $c_0$. Therefore, $m_0^2 \approx k^2 - \omega^2/v_\textrm{A}^2$. For waves with phase speed much less than the Alfv\'{e}n speed, a further approximation of $m_0^2 \approx k^2$ can be made, in which case, the amplitude ratios for quasi-sausage modes (top) and quasi-kink modes (bottom) reduce to
\begin{align}
R_\textrm{A} &= \left(\substack{- \\ +}\right) \frac{\rho_1m_2}{\rho_2m_1} \left[ \frac{(k^2v_\textrm{A}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2k \left(\begin{matrix} \coth \\ \tanh \end{matrix}\right)(kx_0)}{(k^2v_\textrm{A}^2 - \omega^2)m_2\frac{\rho_0}{\rho_2} - \omega^2k \left(\begin{matrix} \coth \\ \tanh \end{matrix}\right)(kx_0)} \right].
\end{align}
These equations can be solved for $v_\textrm{A}$ to give
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2} \left[1 + k \left( \frac{ \frac{\rho_1}{\rho_0m_1} \left(\substack{+ \\ -}\right) R_\textrm{A}\frac{\rho_2}{\rho_0m_2}}{1 \left(\substack{+ \\ -}\right) R_\textrm{A}} \right) \left(\begin{matrix} \coth \\ \tanh \end{matrix}\right) (kx_0)\right].
\end{equation}
We will return to a discussion of the inversion of the amplitude ratio in Section~\ref{sec: numerical inversion}.


%------------------------------------------------------------------------------
\section{Minimum Perturbation Shift Method}
\label{sec: MPSM}
%------------------------------------------------------------------------------

A second spatial magneto-seismology technique uses the shift in the position of minimum wave power from the centre of the slab due to the asymmetry in the external plasma regions as a diagnostic parameter for estimating the slab Alfv\'{e}n speed.

For a symmetric sausage or kink mode, the position of minimum wave power is the central axis of the slab, at $x = 0$. We define $\Delta_\textrm{min}$ to be the displacement (from the central axis of the waveguide) of the position of minimum wave power inside an asymmetric magnetic slab (Figure~\ref{fig: min pert shift}). For quasi-sausage modes, $\Delta_\textrm{min}$ is the solution to $\widehat{v}_x(x) = 0$ under the constraint $|x| < x_0$, and for quasi-kink modes, $\Delta_\textrm{min}$ is the solution to $\textrm{d}\widehat{v}_x (x) / \textrm{d}x = 0$ under the same constraint $|x| < x_0$. The constraint restricts the solutions to being within the slab. 

\begin{figure}
	\makebox[\textwidth][c]{
		\subfloat[]{\scalebox{0.9}{
				\begin{tikzpicture}
				\path [fill=lightgray, opacity=0.5] (2,-1.5) -- (2,1.5) -- (5,1.5) -- (5,-1.5) -- (2,-1.5);
				
				\shade[bottom color=white,top color=lightgray, opacity=0.5] (2,-2) to (5,-2) to (5,-1.5) to (2,-1.5) to (2,-2);
				
				\shade[top color=white,bottom color=lightgray, opacity=0.5] (2,2) to (5,2) to (5,1.5) to (2,1.5) to (2,2);
				
				\draw [-] (2,-2) -- (2,2);
				\draw [-] (5,-2) -- (5,2);
				
				%\draw [ultra thick, red, -stealth,opacity=0.7] (2.5,-1.5) -- (2.5,2);
				%\draw [ultra thick, red, path fading=south, opacity=0.5] (2.5,-2) -- (2.5,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (3,-1.5) -- (3,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (3,-2) -- (3,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (3.5,-1.5) -- (3.5,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (3.5,-2) -- (3.5,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (4,-1.5) -- (4,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (4,-2) -- (4,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (4.5,-1.5) -- (4.5,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (4.5,-2) -- (4.5,-1.5);
				
				%\draw [thick] (0,0.025) to [out=0, in=-178] (1.2, 0.05) to [out=2, in=-120] (2,0.5) to [out=-50, in=165] (3,0) to [out=-15, in=115] (5,-1.5) to [out=65, in=-170] (7,-0.2);
				
				\draw [thick] (1, 0.05) to [out=2, in=-120] (2,0.5) to [out=-50, in=165] (3,0) to [out=-15, in=115] (5,-1.5) to [out=65, in=-160] (6,-0.5);
				
				\draw [->] (1,0) -- (1,2);
				\draw [->] (1,0) -- (6,0);
				
				%\node at (1,1) {$\rho_1$};
				%\node at (6,1) {$\rho_2$};
				%\node [right] at (2.88,1.3) {$\rho_0$};
				
				\small
				\node [below left] at (2.1,0) {$-x_0$};
				\node [below left] at (5.1,0) {$x_0$};
				
				\node [right] at (1,2) {$\widehat{\xi}_x$};
				\node [below] at (6,0) {$x$};
				
				\draw [dashed] (3.5,-2) -- (3.5,2);
				\draw [fill] (3,0) circle [radius=0.07];
				\draw [-] (3, 0.2) to [out=90, in=-90] (3.25, 0.4) to [out=-90, in=90] (3.5, 0.2);
				\node [above] at (3.1, 0.4) {$\Delta_\mathrm{min}$};
				\end{tikzpicture}
			}\label{fig: min pert shift saus}}
		
		
		\subfloat[]{\scalebox{0.9}{
				\begin{tikzpicture}
				\path [fill=lightgray, opacity=0.5] (2,-1.5) -- (2,1.5) -- (5,1.5) -- (5,-1.5) -- (2,-1.5);
				
				\shade[bottom color=white,top color=lightgray, opacity=0.5] (2,-2) to (5,-2) to (5,-1.5) to (2,-1.5) to (2,-2);
				
				\shade[top color=white,bottom color=lightgray, opacity=0.5] (2,2) to (5,2) to (5,1.5) to (2,1.5) to (2,2);
				
				\draw [-] (2,-2) -- (2,2);
				\draw [-] (5,-2) -- (5,2);
				
				%\draw [ultra thick, red, -stealth,opacity=0.7] (2.5,-1.5) -- (2.5,2);
				%\draw [ultra thick, red, path fading=south, opacity=0.5] (2.5,-2) -- (2.5,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (3,-1.5) -- (3,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (3,-2) -- (3,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (3.5,-1.5) -- (3.5,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (3.5,-2) -- (3.5,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (4,-1.5) -- (4,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (4,-2) -- (4,-1.5);
				%\draw [ultra thick, red, -stealth,opacity=0.7] (4.5,-1.5) -- (4.5,2);
				%\draw [ultra thick, red, path fading=south,opacity=0.5] (4.5,-2) -- (4.5,-1.5);
				
				%\draw [thick] (0,0.2) to [out=10, in=245] (2, 1.5) to [out=295, in=180] (4,0.1) to [out=0, in=230] (5,0.5) to [out=300, in=178] (6.2,0.04) to [out=358, in=180] (7,0.02);
				
				\draw [thick] (1,0.3) to [out=10, in=245] (2, 1.5) to [out=295, in=180] (4,0.1) to [out=0, in=230] (5,0.5) to [out=300, in=178] (6,0.04);
				
				\draw [->] (1,0) -- (1,2);
				\draw [->] (1,0) -- (6,0);
				%
				%\node at (1,1) {$\rho_1$};
				%\node at (6,1) {$\rho_2$};
				%\node [right] at (2.88,1.3) {$\rho_0$};
				
				\small
				\node [below left] at (2.1,0) {$-x_0$};
				\node [below left] at (5.1,0) {$x_0$};
				
				\node [right] at (1,2) {$\widehat{\xi}_x$};
				\node [below] at (6,0) {$x$};
				
				\draw [dashed] (3.5,-2) -- (3.5,2);
				\draw [fill] (4,0.1) circle [radius=0.07];
				\draw [-] (3.5, 0.3) to [out=90, in=-90] (3.75, 0.5) to [out=-90, in=90] (4, 0.3);
				\node [above] at (4, 0.5) {$\Delta_\mathrm{min}$};
				\end{tikzpicture}
			}\label{fig: min pert shift kink}}}
	
	\caption{Illustration of the minimum perturbation shift, $\Delta_\textrm{min}$, within the slab (shaded) for~\protect\subref{fig: min pert shift saus}~quasi-sausage and~\protect\subref{fig: min pert shift kink}~quasi-kink modes.}
	\label{fig: min pert shift}
\end{figure}

Firstly, for quasi-sausage modes, using the solution for the transversal velocity amplitude given by Equation~\eqref{vsoln} and the expressions for the variables within given by equation~\eqref{constB C}, the minimum perturbation shift can be calculated as follows. The solution for the transversal velocity amplitude within the slab is
\begin{equation}
\widehat{v}_x(x) = B\cosh{m_0x} + C\sinh{m_0x} = 0,
\end{equation}
where $B$ is given by Equation~\eqref{constB C} and $C$ is arbitrary. This equation is solved for $x$ to give
\begin{equation}
x = \frac{1}{m_0} \tanh^{-1}\left(-\frac{B}{C}\right). \label{disp of min power saus}
\end{equation}
Therefore, the minimum perturbation shift for quasi-sausage modes is
\begin{equation}
\Delta_\textrm{min} = \frac{1}{m_0}\tanh^{-1}\left(-\frac{(k^2{v_\textrm{A}}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2{m_0}\tanh{m_0x_0}}{(k^2{v_\textrm{A}}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1}\tanh{m_0x_0} - \omega^2{m_0}}\right). \label{shift min saus}
\end{equation}
Similarly, for quasi-kink modes, using Equations~\eqref{vsoln} and~\eqref{constB B}, we calculate the minimum perturbation shift to be
\begin{equation}
\Delta_\textrm{min} = \frac{1}{m_0}\coth^{-1}\left(-\frac{(k^2{v_\textrm{A}}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2{m_0}\tanh{m_0x_0}}{(k^2{v_\textrm{A}}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1}\tanh{m_0x_0} - \omega^2{m_0}}\right). \label{shift min kink}
\end{equation}
The dependence of the minimum perturbation shifts on the external plasma region with subscript~2 is implicit in the determination of the eigenfrequency $\omega$ when solving the dispersion relation.

The concept of minimum perturbation shift is exclusive to surface modes. The eigenfunctions of surface modes in a magnetic slab are significantly more sensitive to the external plasma parameters than body modes \citep{all_etal17}. This makes intuitive sense given that the energy in a surface mode is localised to the boundaries of the slab whereas the energy in a body mode is largely isolated within the slab. There is a shift in the spatial nodes and anti-nodes in body mode perturbations within a slab due to changing external plasma parameters, however, it is too small to be an effective observational tool.

Akin to the amplitude ratio method for solar magneto-seismology prescribed in Section~\ref{sec: AR}, we can invert Equation~\eqref{shift min saus} or~\eqref{shift min kink} for the the Alfv\'{e}n speed, $v_\textrm{A}$, and hence get an estimate the magnetic field strength of inhomogeneous solar magnetic structures. This can be done either numerically, using an iterative root finding method, or analytically, under an appropriate approximation. In each of the following subsections, we discuss the analytical inversion procedure under the thin slab (Section~\ref{sec: mps thin}), wide slab (Section~\ref{sec: mps wide}), incompressible (Section~\ref{sec: mps incomp}), and low-beta (Section~\ref{sec: mps low-beta}) approximations.


\subsection{Thin slab approximation} \label{sec: mps thin}
Under the thin slab approximation, that is $kx_0 \ll 1$, we have $m_0x_0 \ll 1$ for surface modes (Section~\ref{sec: thin slab}). By definition, $|\Delta_\textrm{min}| < x_0$, therefore, $m_0|\Delta_\textrm{min}| \ll 1$, so that $\tanh{m_0\Delta_\textrm{min}} \approx m_0\Delta_\textrm{min}$. Firstly, for quasi-sausage modes in a thin slab, Equation~\eqref{shift min saus} can be solved for $v_\textrm{A}$ to give
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2} \left[\frac{\rho_1}{\rho_0m_1}(x_0 + \Delta_\textrm{min}) + \frac{1}{1 + (\omega / kc_0)^2} + k^2x_0\Delta_\textrm{min}\right].
\end{equation}
For quasi-kink modes in a thin slab, Equation~\eqref{shift min kink} can be solved for $v_\textrm{A}$ to give
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2}\left[\frac{-b \pm \sqrt{b^2 - 4ac}}{2a}\right],
\end{equation}
where
\begin{align}
a &= m_1\frac{\rho_0}{\rho_1}(k^2c_0^2 - \omega^2)(x_0 + \Delta_\textrm{min}), \\
b &= -m_1\frac{\rho_0}{\rho_1}(2k^2c_0^2 - \omega^2)(x_0 + \Delta_\textrm{min}) - (k^2c_0^2 - \omega^2), \\
c &= c_0^2m_1\frac{\rho_0}{\rho_1}(x_0 + \Delta_\textrm{min}) + c_0^2 + \omega^2x_0\Delta_\textrm{min}.
\end{align}


\subsection{Wide slab approximation} \label{sec: mps wide}
The concept of minimum perturbation shift is ill-defined under the wide slab approximation, that is, when $kx_0 \gg 1$. In this case, each interface oscillates independently at its own eigenfrequency. Therefore the nomenclature of quasi-sausage and quasi-kink mode breaks down. In the wide slab limit, the eigenfunctions have no local minimum in the slab, instead the perturbations are evanescent away from the oscillating interface, therefore there is no local minimum of wave power within the slab.


\subsection{Incompressible approximation} \label{sec: mps incomp}
When the plasma is incompressible, the sound speeds are unbounded, so that $m_j = k$, for $j = 0, 1, 2$. The minimum perturbation shift for a quasi-sausage mode (top) and quasi-kink (bottom) in an incompressible slab is
\begin{equation}
\Delta_\textrm{min} = \frac{1}{k}\left(\begin{matrix} \tanh^{-1} \\ \coth^{-1} \end{matrix}\right)\left(-\frac{(k^2{v_\textrm{A}}^2-\omega^2)\frac{\rho_0}{\rho_1} - \omega^2\tanh{kx_0}}{(k^2{v_\textrm{A}}^2-\omega^2)\frac{\rho_0}{\rho_1}\tanh{kx_0} - \omega^2}\right),
\end{equation}
which can be solved for $v_\textrm{A}$ to give
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2}\left[1 + \frac{\rho_1}{\rho_0}\left(\begin{matrix} \tanh \\ \coth \end{matrix}\right)(k(x_0 + \Delta_\textrm{min}))\right].
\end{equation}


\subsection{Low-beta approximation} \label{sec: mps low-beta}
In a low-beta plasma, the minimum perturbation shift for a quasi-sausage mode (top) and quasi-kink (bottom) is given by
\begin{equation}
\Delta_\textrm{min} = \frac{1}{k}\left(\begin{matrix} \tanh^{-1} \\ \coth^{-1} \end{matrix}\right)\left(-\frac{(k^2{v_\textrm{A}}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1} - \omega^2k\tanh{kx_0}}{(k^2{v_\textrm{A}}^2 - \omega^2)m_1\frac{\rho_0}{\rho_1}\tanh{kx_0} - \omega^2k}\right),
\end{equation}
which can be solved for $v_\textrm{A}$ to give
\begin{equation}
v_\textrm{A}^2 = \frac{\omega^2}{k^2}\left[1 + \frac{k\rho_1}{m_1\rho_0}\left(\begin{matrix} \tanh \\ \coth \end{matrix}\right)(k(x_0 + \Delta_\textrm{min}))\right].
\end{equation}


\begin{sidewaystable}
	\centering
	\begin{tabular}{lccc}
		\toprule
		\smallskip
		Mode & \multicolumn{3}{c}{Approximation of $k^2v_\textrm{A}^2 / \omega^2$ using the amplitude ratio, $R_\textrm{A}$} \\
		& Thin slab & Incompressible & Low-beta \\
		\midrule
		\smallskip
		Quasi-sausage surface & $ 1 + \frac{1}{x_0}\left(\frac{R_\textrm{A}\frac{\rho_2}{\rho_0m_2} + \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} + 1}\right) $ & $ 1 + \left( \frac{R_\textrm{A} \frac{\rho_2}{\rho_0} + \frac{\rho_1}{\rho_0}}{R_\textrm{A} + 1} \right) \coth{kx_0} $ & $ 1 + k \left( \frac{ R_\textrm{A}\frac{\rho_2}{\rho_0m_2} + \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} + 1} \right) \coth{kx_0} $ \\
		Quasi-kink surface & $ 1 + k^2x_0\left(\frac{R_\textrm{A}\frac{\rho_2}{\rho_0m_2} - \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} - 1}\right) $ & $ 1 + \left( \frac{R_\textrm{A} \frac{\rho_2}{\rho_0} - \frac{\rho_1}{\rho_0}}{R_\textrm{A} - 1} \right) \tanh{kx_0} $ & $ 1 + k \left( \frac{ R_\textrm{A}\frac{\rho_2}{\rho_0m_2} - \frac{\rho_1}{\rho_0m_1}}{R_\textrm{A} - 1} \right) \tanh{kx_0} $ \\
		\bottomrule
	\end{tabular}
	\caption{Magneto-seismology inversion using the amplitude ratio, $R_\textrm{A}$, to approximate the Alfv\'{e}n speed, $v_\textrm{A}$.}
	\label{table: amp ratio}

	\bigskip\bigskip\bigskip\bigskip\bigskip

	\begin{tabular}{lccc}
		\toprule
		\smallskip
		Mode & \multicolumn{3}{c}{Approximation of $k^2v_\textrm{A}^2 / \omega^2$ using the minimum perturbation shift, $\Delta_\textrm{min}$} \\
		& Thin slab & Incompressible & Low-beta \\
		\midrule
		\smallskip
		Quasi-sausage surface & $ \frac{\rho_1}{\rho_0m_1}(x_0 + \Delta_\textrm{min}) + \frac{1}{1 + (\omega / kc_0)^2} + k^2x_0\Delta_\textrm{min} $ & $ 1 + \frac{\rho_1}{\rho_0}\tanh{k(x_0 + \Delta_\textrm{min})} $ & $ 1 + \frac{k\rho_1}{m_1\rho_0}\tanh{k(x_0 + \Delta_\textrm{min})} $ \\
		Quasi-kink surface & $\frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$, defined in Section~\ref{sec: mps thin} & $ 1 + \frac{\rho_1}{\rho_0}\coth{k(x_0 + \Delta_\textrm{min})} $ & $ 1 + \frac{k\rho_1}{m_1\rho_0}\coth{k(x_0 + \Delta_\textrm{min})} $ \\
		\bottomrule		
	\end{tabular}
	\caption{Magneto-seismology inversion using the minimum perturbation shift, $\Delta_\textrm{min}$, to approximate the Alfv\'{e}n speed, $v_\textrm{A}$.}
	\label{table: min pert shift}
\end{sidewaystable}


%------------------------------------------------------------------------------
\section{Discussion of inversion procedure}
\label{sec: inversion}
%------------------------------------------------------------------------------
\color{red}
REWRITE FROM HERE

We have introduced the amplitude ratio and the minimum perturbation shift which quantify the spatial asymmetry in magnetic slab eigenmodes. These expressions can be applied to determine the Alfv\'{e}n speed, for a given set of observed equilibrium parameters, providing us a novel method to diagnose information about the background plasma, thus advancing the field of spatial magneto-seismology.

A summary of the analytical expressions for estimating the Alfv\'{e}n speed, $v_\textrm{A}$, within an asymmetric magnetic slab is given in Tables~\ref{table: amp ratio} and~\ref{table: min pert shift}, utilising the amplitude method and the minimum perturbation shift methods, respectively. In practice, a numerical procedure could be made relatively simple and computationally inexpensive by making use of a standard root finding method once the observed parameters have been prescribed but in some cases it might be valid to use an analytical solution from Tables~\ref{table: amp ratio} and~\ref{table: min pert shift} under the necessary approximation.

\begin{figure}
	\centering
	\subfloat[Quasi-kink]{\includegraphics[scale=0.38]{\figuredir slow-kink-surf_amp-ratio.pdf}
		\label{fig: AR slow kink surf}}
	\subfloat[Quasi-sausage]{\includegraphics[scale=0.38]{\figuredir slow-saus-surf_amp-ratio.pdf}
		\label{fig: AR slow saus surf}}
	\\
	\subfloat[Quasi-kink]{\includegraphics[scale=0.38]{\figuredir slow-kink-surf_min-pert-shift.pdf}
		\label{fig: MPS slow kink surf}}
	\subfloat[Quasi-sausage]{\includegraphics[scale=0.38]{\figuredir slow-saus-surf_min-pert-shift.pdf}
		\label{fig: MPS slow saus surf}}
	\caption{(\protect\subref*{fig: AR slow kink surf}, \protect\subref*{fig: AR slow saus surf}) The amplitude ratio, $R_\textrm{A}$, and (\protect\subref*{fig: MPS slow kink surf}, \protect\subref*{fig: MPS slow saus surf}) the minimum perturbation shift, $\Delta_\textrm{min}$, as a function of the slab width, non-dimensionalised to $kx_0$, and the density ratio, $\rho_1/\rho_0$, for slow (\protect\subref*{fig: AR slow kink surf}, \protect\subref*{fig: MPS slow kink surf}) quasi-kink and (\protect\subref*{fig: AR slow saus surf}, \protect\subref*{fig: MPS slow saus surf}) quasi-sausage surface modes. The other density ratio is set to $\rho_2/\rho_0 = 2$, the characteristic speed ordering inside the slab is $v_\textrm{A}=1.3c_0$, and the sound speed outside the slab is determined to ensure equilibrium pressure balance.}
	\label{fig: AR MPS}
\end{figure}

Figure~\ref{fig: AR MPS} illustrates the dependency of the amplitude ratio and minimum perturbation shift on the (non-dimensionalised) slab width, $kx_0$, and the density ratio, $\rho_1/\rho_0$, of one external plasma density to the slab density, holding the other external density fixed. Varying one density ratio in this way is equivalent to changing the asymmetry of the system. The amplitude ratio is positive (negative) for quasi-kink (quasi-sausage) modes, because the oscillations on each boundary are in phase (anti-phase). Figures~\ref{fig: AR slow kink surf} and~\ref{fig: AR slow saus surf} further show that, for a given background parameter regime, the boundary with the highest amplitude is different for quasi-kink and quasi-sausage modes. This is demonstrated by the absolute value of the amplitude ratio being greater than 1 for quasi-sausage modes when it is less than 1 for quasi-kink modes, and \textit{vice versa}. This is in agreement with the properties of the eigenmodes of the analogous spring-mass system introduced by \cite{all_etal17}. Figures~\ref{fig: MPS slow kink surf} and~\ref{fig: MPS slow saus surf} demonstrate that the position of minimum perturbation for quasi-kink modes is shifted in the opposite direction to that of quasi-sausage modes.

There are a number of ways that the amplitude ratio or minimum perturbation shift can be used for spatial seismology. For a given observed wave event in a slab-like solar atmospheric structure, the most simple procedure is as follows. Take measurements for the wave parameters (period and wavelength), and the background parameters (width of structure, plasma density in each region). Determine the sound speeds by assuming equilibrium pressure balance across the slab boundaries. Take a measurement of either the amplitude ratio or minimum perturbation shift. Then invert the corresponding expression for the spatial wave distribution parameter, Equation~\eqref{cross-slab ratio saus}, \eqref{cross-slab ratio kink}, \eqref{shift min saus}, or~\eqref{shift min kink}, to estimate the Alfv\'{e}n speed.

However, it is often the case that not all the non-magnetic parameters characterising a waveguide are well-observable. In this case, the dispersion relation can be solved simultaneously with the equation for the amplitude ratio or the minimum perturbation shift to approximate the Alfv\'{e}n speed and another unknown parameter. For example, Figure~\ref{fig: vA approx} shows the inversion curves for a particular parameter regime typical of a slow surface mode. It is plotted by prescribing (as if they were observed quantities) all plasma parameters except the Alfv\'{e}n speed, $v_\textrm{A}$, and one of the density ratios, $\rho_1/\rho_0$, then simultaneously solving the dispersion relation, Equation~\eqref{disp rel}, with the expressions for the amplitude ratio, Equation~\eqref{cross-slab ratio saus} or~\eqref{cross-slab ratio kink}, or the minimum perturbation shift, Equation~\eqref{shift min saus} or~\eqref{shift min kink}. The solution curves were found numerically.

\begin{figure}
	\centering
	\subfloat[Amplitude ratio inversion]{\includegraphics[scale=0.42]{\figuredir RA_vA_approx_2var.pdf}
		\label{fig: RA vA approx}}
	\subfloat[Minimum perturbation shift inversion]{\includegraphics[scale=0.42]{\figuredir DM_vA_approx_2var.pdf}
		\label{fig: DM vA approx}}
	\caption{Using prescribed values for~\protect\subref{fig: RA vA approx}~the amplitude ratio, $R_\textrm{A}$, or~\protect\subref{fig: DM vA approx}~the minimum perturbation shift, $\Delta_\textrm{min}$, a numerical inversion is used to approximate the background equilibrium parameters, in this case the Alfv\'{e}n speed, $v_\textrm{A}$, and one of the density ratios, $\rho_1 / \rho_0$, for slow magneto-acoustic modes. Dashed (solid) lines correspond to the inversion curves for slow quasi-kink (quasi-sausage) surface modes. The dotted lines indicate the inversion for symmetric kink and sausage modes. The light-shaded area indicates the values of the Alfv\'{e}n speed which correspond to body modes, rather than surface modes, so are not important for SMS application. The dark shaded region in Figure~\protect\subref{fig: DM vA approx} illustrates the region outside the slab, outside the bounds of the minimum perturbation shift.}
	\label{fig: vA approx}
\end{figure}

Plasma density measurements often have low accuracy and large uncertainty. These uncertainties will propagate through the inversion of the amplitude ratio or minimum perturbation shift to lead to uncertainties in the diagnosis of the Alfv\'{e}n speed. Measuring the density ratio is likely to be the source of the largest uncertainty in the estimation, since errors in spatial parameters such as the half slab width, $x_0$, and temporal parameters, such as the angular frequency, $\omega$, are generally much smaller. The propagation of the error in the density ratios is reduced by a factor of two by the square root that is introduced when inverting $v_A$ from $k^2v_A^2/\omega^2$ (in a similar way to \citealt{nak_etal01}). Furthermore, by following the numerical approach described in the previous paragraph, measurement of only one of the density ratios is necessary to estimate the Alfv\'{e}n speed. Therefore, combined with high precision methods using density-sensitive emission lines \citep{you_etal09}, the propagation of density measurement errors can be reduced.

The amplitude ratio has a strong sensitivity to the changes in the external densities, and therefore the external asymmetry, whereas the minimum perturbation shift has a weaker dependency. Therefore, the amplitude ratio is likely to be a more effective parameter for diagnosing background parameters. Furthermore, observations of the location of the minimum wave power within a solar magnetic slab will be fraught with noise, potentially causing the detection of a false minimum. Noise in amplitude ratio measurements is less likely to introduce large errors because the locations of the slab boundaries are a more obvious features and can be identified by the steep gradients in the wavelength of observed light, for example, and is stable to larger noise signals.

Both the amplitude ratio and minimum perturbation shift are more sensitive to small changes in the background equilibrium parameters, \emph{i.e.} the asymmetry in the background plasma, than the eigenfrequencies are. On a theoretical level, this corroborates with the result that eigenfunctions of linear operators on a Hilbert space are often more sensitive to small perturbations of the operator than their corresponding eigenvalues \citep{kat95}. The amplitude ratio and minimum perturbation shift both depend on the eigenfunctions, $\widehat{v}_x(x)$, and their eigenvalues, $\omega^2$. This means that spatial seismology techniques can be theoretically more effective than temporal techniques for many solar structure. Therefore, we are excited to see a push for increased spatial resolution with next-generational observational instrumentation such as the Daniel K. Inouye Solar Telescope (DKIST). Upon completion, this will equip us to be able to use the magneto-seismology techniques developed here to better understand the diagnostic properties of asymmetric slab-like solar atmospheric structures such as elongated magnetic bright points, prominences, and sunspot light walls.

Large magnetic bright points (MBPs), with characteristic length $L > 500$ km, along inter-granular lanes are often rather elongated \citep{cro_etal10}. The application of SMS techniques to MBPs is limited by the low spatial resolution of current observations. DKIST is going to have a spatial resolution of 19 km for structures on the solar surface \citep{tri_etal15}, sufficient enough to resolve oscillations in MBPs. This unprecedented resolution will hopefully give the sufficient number of pixels (5-10) across an MBP to determine whether their oscillations have maximum power at the boundaries of or within the waveguide, that is, to differentiate between the transverse eigenfunctions of surface and body MHD modes, respectively. This is crucial for the accurate employment of these SMS techniques, and would build upon previous work on mode identification such as the surface modes that were identified in photospheric pores \citep{mor_etal15}.

Quiescent prominences, which are large long-lived magnetic formations of cool dense plasma elevated into the hot and rarefied coronal atmosphere, can be approximated by magnetic slabs and have been regularly observed to guide MHD waves \citep{arr_etal12}. The basic slab model of prominences, as illustrated by \textit{e.g.} \cite{joa_etal92a,joa_etal92b}, is of a symmetric slab, however, a small asymmetry could easily be caused by adjacent inhomogeneities. Even a small asymmetry in density ($|1 - \rho_1/\rho_2| < 0.1$) can cause a significant (factor of 2 or more) asymmetry in the eigenmode (Figure~\ref{fig: AR MPS}), except for in thin slabs. This makes prominences a good candidate for applying the SMS techniques developed here. One issue that one has to bear in mind for the employment of these techniques is that the approximation of simple asymmetric magnetic slab may be insufficient to capture some important aspects of prominence oscillations, in particular, prominences are likely to have a sheared magnetic field and may have significant flows, which are neglected in the asymmetric slab model \citep{van_etal89,zir_etal94,bal05,oli09,arr_etal12}.

Light bridge surges also present a possible application for the SMS techniques developed here. Rooted in sunspot light bridges, these clusters of recurrent chromospheric surges observed as bright structures in \textit{e.g.} IRIS 1330~\AA~line, as observed by \citealt{yan_etal16} are formed by either magnetic reconnection just above the light bridge \citep{tor_etal15,rob_etal16} or by leakage of p-modes from beneath the underlying photosphere \citep{yan_etal15,zha_etal17}. They have been demonstrated to guide MHD waves driven by nearby disturbances \citep{yan_etal16,yan_etal17}. While the asymmetric magnetic slab could be a valid approximation for the actual geometry of light walls, the strong magnetic field in the low solar atmosphere above a sunspot umbra (the plasma each side of the light bridge) may put into question the full validity of the non-magnetic external plasma in the current model. However, what matters is the relative strength of the magnetic force compared to the pressure gradient force, that is, the value of plasma-beta. The value of beta above magnetic pores and sunspots is uncertain, but has been shown to be rather high in some cases \citep{bou17}, and has therefore been used in models of the low atmosphere \citep{mum_etal15}. With improved observations, it may turn out that the plasma surrounding light walls has a low-beta, in which case, we suggest that a future generalisation of the methods described here which involves an asymmetric magnetic plasma outside the slab will be a more appropriate method for the first magneto-seismology diagnosis of sunspot light walls.

Of course, these methods have limits of applicability due to the fact that we have modelled the slab as infinitely long, yet there do not exist any infinitely long waveguides in the solar atmosphere. However, if the length, L, of the cross section of an observed solar waveguide is much greater than its width, $x_0$, say $L/x_0=5-10$, then this model of an infinitely long slab may be a valid approximation. Furthermore, if the wavelength of the observed wave, $\lambda$, is such that $L \gg \lambda \gg x_0$, then the thin slab approximation holds (Sections~\ref{sec: AR thin slab} and~\ref{sec: min pert shift thin}), therefore an analytical diagnosis of the Alfv\'{e}n speed within the waveguide can be made using Table~\ref{table: amp ratio} or~\ref{table: min pert shift}.

This paper introduces two novel SMS methods that, for the first time, explore the asymmetry of solar magnetic waveguides to diagnose background parameters. While the simplicity of the current model of an infinitely long slab in a non-magnetic environment introduces several problems with applicability of the methods, the focus is on the novel concept of waveguide asymmetry. Future advancements of these methods involving more complex equilibrium conditions will be valuable in the coming age of high-resolution solar observations. We propose to determine whether asymmetric magneto-acoustic surface waves can be excited within the characteristic lifetime of an asymmetric waveguide in the solar atmosphere. This task can be investigated analytically (for linear waves with simple initial conditions) and numerically (for non-linear waves with more sophisticated initial conditions). Further, a more realistic system, in particular, an asymmetric magnetic fields in the external plasmas, or an equilibrium shear flow, would allow for better application to the solar waveguides discussed above, at the expense of analytic tractability.

\color{black}

%------------------------------------------------------------------------------
\section{Diagnosing the Alfv\'{e}n speed of chromospheric fibrils}
\label{sec: fibrils}
%------------------------------------------------------------------------------

\subsection{Methodology}


\subsection{Results}


\subsection{Discussion}

\subsubsection{Possible alternative causes of observed asymmetry}
Possibilities: 
\begin{itemize}
	\item Asymmetric ICs
	\item Non-collective oscillations
	\item Observational artefact
	\item Overlying oscillating waveguides due to optically thin atmosphere.
\end{itemize}
Include discussion about how to differentiate between these.




\bibliographystyle{plainnat}
\bibliography{../main/references}  

\end{document}
